6:52:40 PM [express] POST /api/payments/webhook 200 in 4ms :: {"received":true,"error":"Webhook proc‚Ä¶
üöÄ === WEBHOOK MERCADO PAGO RECEBIDO ===
üìÖ Timestamp: 2025-06-24T18:52:40.263Z
üì¶ Body: {
  "action": "payment.created",
  "api_version": "v1",
  "data": {
    "id": "116221021630"
  },
  "date_created": "2025-06-24T18:52:39Z",
  "id": 122351422485,
  "live_mode": true,
  "type": "payment",
  "user_id": "593494225"
}
üîç Processando pagamento Mercado Pago ID: 116221021630
üìä Status do pagamento MP: rejected
üîó External Reference: user_8_3EWtyFcBsKW2cgW14MN4u
‚ÑπÔ∏è Pagamento n√£o aprovado - Status: rejected
6:52:40 PM [express] POST /api/payments/webhook 200 in 110ms :: {"received":true}
‚úÖ Pagamento salvo no banco: ID 52
üîó External Reference: user_8_3EWtyFcBsKW2cgW14MN4u
6:52:40 PM [express] POST /api/payments/create-pix 200 in 2157ms :: {"success":true,"payment":{"id":‚Ä¶
[ADMIN DASHBOARD] Download URL do Supabase: https://nova-url-teste.com/loader.exe
6:52:45 PM [express] GET /api/admin/dashboard 200 in 2499ms :: {"stats":{"totalUsers":8,"activeLicen‚Ä¶
‚è±Ô∏è Processando 2 licen√ßas ativas...
‚è≥ Usu√°rio 8da865b1-f6ab-4c76-a0e2-b6ecbe115cb2: 1384 minutos restantes
‚è≥ Usu√°rio 4e02645e-6594-4103-a724-17ce4a5f2c9b: 18 minutos restantes
‚úÖ Processamento conclu√≠do: 2 licen√ßas atualizadas
üîß === FOR√áANDO APROVA√á√ÉO DE PAGAMENTO ===
Payment ID: 52
üí≥ Pagamento encontrado: user_8_3EWtyFcBsKW2cgW14MN4u
üë§ Usu√°rio: admin@fovdark.com
=== ATIVANDO LICEN√áA INTEGRADA ===
Usu√°rio: 8da865b1-f6ab-4c76-a0e2-b6ecbe115cb2
Plano: 7days
Dura√ß√£o: 7 dias
Chave: FOV-GIN9ZGH
Expira em: 2025-07-01T18:53:32.000Z
Total minutos: 10080
‚úÖ LICEN√áA ATIVADA NO USU√ÅRIO
Status: ativa
Plano: 7days
Expira em: 2025-07-01T18:53:32.000Z
‚ùå Erro ao for√ßar aprova√ß√£o: PostgresError: duplicate key value violates unique constraint "payments_mercado_pago_id_unique"
    at ErrorResponse (file:///app/node_modules/postgres/src/connection.js:794:26)
    at handle (file:///app/node_modules/postgres/src/connection.js:480:6)
    at TLSSocket.data (file:///app/node_modules/postgres/src/connection.js:315:9)
    at TLSSocket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
    at Readable.push (node:internal/streams/readable:392:5)
    at TLSWrap.onStreamRead (node:internal/stream_base_commons:191:23) {
  severity_local: 'ERROR',
  severity: 'ERROR',
  code: '23505',
  detail: 'Key (mercado_pago_id)=(FORCE_APPROVED_TEST) already exists.',
  schema_name: 'public',
  table_name: 'payments',
  constraint_name: 'payments_mercado_pago_id_unique',
  file: 'nbtinsert.c',
  line: '666',
  routine: '_bt_check_unique'
}
6:53:32 PM [express] POST /api/test/force-approve-payment 500 in 1751ms :: {"success":false,"message‚Ä¶
‚è±Ô∏è Processando 2 licen√ßas ativas...
‚è≥ Usu√°rio 4e02645e-6594-4103-a724-17ce4a5f2c9b: 15 minutos restantes
‚è≥ Usu√°rio 8da865b1-f6ab-4c76-a0e2-b6ecbe115cb2: 10078 minutos restantes
‚úÖ Processamento conclu√≠do: 2 licen√ßas atualizadas
6:54:53 PM [express] GET /api/auth/user 401 in 888ms :: {"message":"N√£o autorizado"}
6:54:54 PM [express] GET /api/dashboard 401 in 180ms :: {"message":"N√£o autorizado"}
6:54:55 PM [express] GET /api/dashboard 401 in 182ms :: {"message":"N√£o autorizado"}
6:54:58 PM [express] GET /api/dashboard 401 in 183ms :: {"message":"N√£o autorizado"}
6:55:05 PM [express] GET /api/auth/user 401 in 185ms :: {"message":"N√£o autorizado"}
6:55:05 PM [express] GET /api/dashboard 401 in 187ms :: {"message":"N√£o autorizado"}
6:55:07 PM [express] GET /api/dashboard 401 in 190ms :: {"message":"N√£o autorizado"}
6:55:09 PM [express] GET /api/dashboard 401 in 180ms :: {"message":"N√£o autorizado"}
==> Detected service running on port 10000
==> Docs on specifying a port: https://render.com/docs/web-services#port-binding
‚è±Ô∏è Processando 2 licen√ßas ativas...
‚è≥ Usu√°rio 4e02645e-6594-4103-a724-17ce4a5f2c9b: 13 minutos restantes
‚è≥ Usu√°rio 8da865b1-f6ab-4c76-a0e2-b6ecbe115cb2: 10076 minutos restantes
‚úÖ Processamento conclu√≠do: 2 licen√ßas atualizadas
6:56:07 PM [express] POST /api/auth/logout 200 in 1476ms :: {"message":"Logout realizado com sucesso‚Ä¶
‚è±Ô∏è Processando 2 licen√ßas ativas...
‚è≥ Usu√°rio 4e02645e-6594-4103-a724-17ce4a5f2c9b: 11 minutos restantes
‚è≥ Usu√°rio 8da865b1-f6ab-4c76-a0e2-b6ecbe115cb2: 10074 minutos restantes
‚úÖ Processamento conclu√≠do: 2 licen√ßas atualizadas
6:57:18 PM [express] POST /api/auth/login 200 in 3438ms :: {"user":{"id":"8da865b1-f6ab-4c76-a0e2-b6‚Ä¶
üîß === FOR√áANDO APROVA√á√ÉO DE PAGAMENTO ===
Payment ID: 51
6:57:18 PM [express] GET /api/dashboard 401 in 181ms :: {"message":"N√£o autorizado"}
üí≥ Pagamento encontrado: user_4306_Pa_52XrWpkt4gpl2pikza
üë§ Usu√°rio: luizsalles102@gmail.com
=== ATIVANDO LICEN√áA INTEGRADA ===
Usu√°rio: 4306c475-2fd7-415b-97fa-e7a3efb0088a
Plano: 7days
Dura√ß√£o: 7 dias
Chave: FOV-1HXF4ZE
Expira em: 2025-07-01T18:57:19.163Z
Total minutos: 10080
‚úÖ LICEN√áA ATIVADA NO USU√ÅRIO
Status: ativa
Plano: 7days
Expira em: 2025-07-01T18:57:19.163Z
‚ùå Erro ao for√ßar aprova√ß√£o: PostgresError: duplicate key value violates unique constraint "payments_mercado_pago_id_unique"
    at ErrorResponse (file:///app/node_modules/postgres/src/connection.js:794:26)
    at handle (file:///app/node_modules/postgres/src/connection.js:480:6)
    at TLSSocket.data (file:///app/node_modules/postgres/src/connection.js:315:9)
    at TLSSocket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
    at Readable.push (node:internal/streams/readable:392:5)
    at TLSWrap.onStreamRead (node:internal/stream_base_commons:191:23) {
  severity_local: 'ERROR',
  severity: 'ERROR',
  code: '23505',
  detail: 'Key (mercado_pago_id)=(FORCE_APPROVED_TEST) already exists.',
  schema_name: 'public',
  table_name: 'payments',
  constraint_name: 'payments_mercado_pago_id_unique',
  file: 'nbtinsert.c',
  line: '666',
  routine: '_bt_check_unique'
}
6:57:19 PM [express] POST /api/test/force-approve-payment 500 in 3411ms :: {"success":false,"message‚Ä¶
6:57:19 PM [express] GET /api/dashboard 401 in 185ms :: {"message":"N√£o autorizado"}
6:57:22 PM [express] GET /api/dashboard 401 in 184ms :: {"message":"N√£o autorizado"}
‚è±Ô∏è Processando 3 licen√ßas ativas...
‚è≥ Usu√°rio 8da865b1-f6ab-4c76-a0e2-b6ecbe115cb2: 10071 minutos restantes
‚è≥ Usu√°rio 4e02645e-6594-4103-a724-17ce4a5f2c9b: 8 minutos restantes
6:57:25 PM [express] GET /api/auth/user 401 in 187ms :: {"message":"N√£o autorizado"}
6:57:26 PM [express] GET /api/dashboard 401 in 185ms :: {"message":"N√£o autorizado"}
‚è≥ Usu√°rio 4306c475-2fd7-415b-97fa-e7a3efb0088a: 10079 minutos restantes
‚úÖ Processamento conclu√≠do: 3 licen√ßas atualizadas
6:57:27 PM [express] GET /api/dashboard 401 in 187ms :: {"message":"N√£o autorizado"}
6:57:29 PM [express] GET /api/dashboard 401 in 180ms :: {"message":"N√£o autorizado"}
6:57:35 PM [express] GET /api/admin/dashboard 401 in 179ms :: {"message":"N√£o autorizado"}
6:57:38 PM [express] POST /api/auth/logout 200 in 736ms :: {"message":"Logout realizado com sucesso"}
‚è±Ô∏è Processando 3 licen√ßas ativas...
‚è≥ Usu√°rio 8da865b1-f6ab-4c76-a0e2-b6ecbe115cb2: 10069 minutos restantes
‚è≥ Usu√°rio 4e02645e-6594-4103-a724-17ce4a5f2c9b: 6 minutos restantes
‚è≥ Usu√°rio 4306c475-2fd7-415b-97fa-e7a3efb0088a: 10077 minutos restantes
‚úÖ Processamento conclu√≠do: 3 licen√ßas atualizadas